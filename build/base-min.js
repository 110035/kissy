/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Jun 17 23:49
*/
KISSY.add("base/attribute",function(i,p,f){function k(a,b){return"string"==typeof b?a[b]:b}function n(a,b,c,e,d,g,f,h){f=f||c;return a.fire(b+i.ucfirst(c)+"Change",i.mix({attrName:f,subAttrName:g,prevVal:e,newVal:d},h))}function j(a,b){var c=a[b];c||(a[b]=c={});return c}function h(a){return j(a,"__attrs")}function l(a){return j(a,"__attrVals")}function s(a,b){for(var c=0,e=b.length;a!=f&&c<e;c++)a=a[b[c]];return a}function t(a){var b;-1!==a.indexOf(".")&&(b=a.split("."),a=b.shift());return{path:b,
name:a}}function u(a,b,c){var e=c;if(b){var a=e=a===f?{}:i.clone(a),d=b.length-1;if(0<=d){for(var g=0;g<d;g++)a=a[b[g]];a!=f&&(a[b[g]]=c)}}return e}function v(a,b,c,e,d){var g,h,k;g=t(b);var n=b,b=g.name;g=g.path;k=a.get(b);var o=b,l=j(a,"__defaultBeforeFns");l[o]||(l[o]=1,o="before"+i.ucfirst(o)+"Change",a.publish(o,{defaultFn:w}));g&&(h=s(k,g));if(!g&&k===c||g&&h===c)return f;c=u(k,g,c);c=i.mix({attrName:b,subAttrName:n,prevVal:k,newVal:c,_opts:e,_attrs:d,target:a},e.data);if(e.silent){if(m===w.call(a,
c))return m}else if(m===a.fire("before"+i.ucfirst(b)+"Change",c))return m;return a}function w(a){if(a.target!==this)return f;var b=a.newVal,c=a.prevVal,e=a.attrName,d=a.subAttrName,g=a._attrs,a=a._opts,b=this.setInternal(e,b);if(b===m)return b;a.silent||(b=l(this)[e],n(this,"after",e,c,b,d,null,a.data),g?g.push({prevVal:c,newVal:b,attrName:e,subAttrName:d}):n(this,"","*",[c],[b],[d],[e],a.data));return f}function q(){}function r(a,b){var c=h(a),e=j(c,b),d=e.valueFn;if(d&&(d=k(a,d)))d=d.call(a),d!==
f&&(e.value=d),delete e.valueFn,c[b]=e;return e.value}function x(a,b,c,e){var d,g;d=t(b);b=d.name;if(d=d.path)g=a.get(b),c=u(g,d,c);if((d=j(h(a),b).validator)&&(d=k(a,d)))if(a=d.call(a,c,b,e),a!==f&&!0!==a)return a;return f}q.INVALID={};var y=q.INVALID,m=!1;i.augment(q,p.Target,{getAttrs:function(){return h(this)},getAttrVals:function(){var a={},b,c=h(this);for(b in c)a[b]=this.get(b);return a},addAttr:function(a,b,c){var e=h(this),d,b=i.clone(b);(d=e[a])?i.mix(d,b,c):e[a]=b;return this},addAttrs:function(a,
b){var c=this;i.each(a,function(a,b){c.addAttr(b,a)});b&&c.set(b);return c},hasAttr:function(a){return h(this).hasOwnProperty(a)},removeAttr:function(a){this.hasAttr(a)&&(delete h(this)[a],delete l(this)[a]);return this},set:function(a,b,c){if(i.isPlainObject(a)){var c=b||{},b=Object(a),e=[],d,g=[];for(a in b)(d=x(this,a,b[a],b))!==f&&g.push(d);if(g.length)return c.error&&c.error(g),m;for(a in b)v(this,a,b[a],c,e);var h=[],k=[],j=[],l=[];i.each(e,function(a){k.push(a.prevVal);j.push(a.newVal);h.push(a.attrName);
l.push(a.subAttrName)});h.length&&n(this,"","*",k,j,l,h,c.data);return this}c=c||{};d=x(this,a,b);return d!==f?(c.error&&c.error(d),m):v(this,a,b,c)},setInternal:function(a,b){var c=f,e=j(h(this),a).setter;if(e&&(e=k(this,e)))c=e.call(this,b,a);if(c===y)return m;c!==f&&(b=c);l(this)[a]=b;return f},get:function(a){var b,c=l(this),e,d;-1!==a.indexOf(".")&&(b=a.split("."),a=b.shift());e=j(h(this),a).getter;d=a in c?c[a]:r(this,a);if(e&&(e=k(this,e)))d=e.call(this,d,a);!(a in c)&&d!==f&&(c[a]=d);b&&(d=
s(d,b));return d},reset:function(a,b){if("string"==typeof a)return this.hasAttr(a)?this.set(a,r(this,a),b):this;var b=a,c=h(this),e={};for(a in c)e[a]=r(this,a);this.set(e,b);return this}});return q},{requires:["event/custom"]});
KISSY.add("base",function(i,p){function f(f){var i=this.constructor;for(this.userConfig=f;i;){var j=i.ATTRS;if(j){var h=void 0;for(h in j)this.addAttr(h,j[h],!1)}i=i.superclass?i.superclass.constructor:null}if(f)for(var l in f)this.setInternal(l,f[l])}i.augment(f,p);f.Attribute=p;return i.Base=f},{requires:["base/attribute","event/custom"]});
