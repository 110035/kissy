/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: May 15 20:33
*/
KISSY.add("component/base",function(g,j,e,b){g.mix(j,{Controller:e,Render:b});return j},{requires:["./base/impl","./base/controller","./base/render"]});
KISSY.add("component/base/box-render",function(g,j,e,b){function h(){if(!this.get("srcNode")){var a=this.getAttrs(),c,b=this.get("renderData");for(c in a)"renderData"!=c&&!(c in b)&&(b[c]=this.get(c))}}var a=g.all,f=g.UA,c=g.Env.host.document;h.ATTRS={id:{},el:{},elCls:{sync:0,setter:function(a){"string"==typeof a&&(a=a.split(/\s+/));return a}},elStyle:{sync:0},width:{sync:0},height:{sync:0},elAttrs:{sync:0},elBefore:{sync:0},render:{},visible:{sync:0},contentTpl:{value:"{{{content}}}"},renderData:{},
childrenElSelectors:{value:{}}};h.HTML_PARSER={content:function(a){return a.html()}};h.prototype={__createDom:function(){var c=this,f=c.get("renderData"),i;if(i=c.get("srcNode")){if((i=a(i))&&!i[0].id)i[0].id="ks-component"+g.guid()}else{i=b+c.get("contentTpl")+"</div>";i=(new e(i,{commands:{getCssClassWithState:function(a,b){return c.getCssClassWithState(b.params[0])}}})).render(f);i=a(i);var f=c.get("childrenElSelectors"),h;for(h in f){var k=f[h];"function"===typeof k?c.setInternal(h,k(i)):c.setInternal(h,
i.all(g.substitute(k,this.get("renderData"))))}}c.setInternal("el",i)},__renderUI:function(){if(!this.get("srcNode")){var a=this.get("render"),b=this.get("el"),f=this.get("elBefore");f?b.insertBefore(f,void 0):a?b.appendTo(a,void 0):b.appendTo(c.body,void 0)}},_onSetWidth:function(a){this.get("el").width(a)},_onSetHeight:function(a){this.get("el").height(a)},_onSetContent:function(a){var c=this.get("el");c.html(a);9>f.ie&&!this.get("allowTextSelection")&&c.unselectable()},_onSetVisible:function(a){var c=
this.get("el"),b=this.getCssClassWithState("shown"),f=this.getCssClassWithState("hidden");a?(c.removeClass(f),c.addClass(b)):(c.removeClass(b),c.addClass(f))},__destructor:function(){var a=this.get("el");a&&a.remove()}};return h},{requires:["node","xtemplate","./box-tpl"]});KISSY.add("component/base/box-tpl",function(){return'<div id="ks-component{{id}}" class="{{getCssClassWithState ""}} {{#if visible}} {{getCssClassWithState "shown"}} {{else}} {{getCssClassWithState "hidden"}} {{/if}} {{#each elCls}} {{.}} {{/each}} " {{#each elAttrs}} {{xkey}}="{{.}}" {{/each}} style=" {{#each elStyle}} {{xkey}}:{{.}}; {{/each}} {{#if width}} width:{{width}}; {{/if}} {{#if height}} height:{{height}}; {{/if}} ">'});
KISSY.add("component/base/box",function(g){function j(){}function e(b){"number"==typeof b&&(b+="px");return b}j.ATTRS={id:{view:1,valueFn:function(){return g.guid()}},content:{view:1,value:""},contentTpl:{view:1},renderData:{view:1,value:{}},childrenElSelectors:{view:1},width:{view:1,setter:e},height:{view:1,setter:e},elCls:{view:1,value:[]},elStyle:{view:1,value:{}},elAttrs:{view:1,value:{}},elBefore:{view:1},el:{view:1},render:{view:1},visible:{sync:0,value:!0,view:1},srcNode:{view:1}};j.prototype=
{_onSetVisible:function(b){this.fire(b?"show":"hide")},show:function(){this.render();this.set("visible",!0);return this},hide:function(){this.set("visible",!1);return this}};return j});
KISSY.add("component/base/controller",function(g,j,e,b,h,a,f,c){function p(d){return function(a){this==a.target&&(a=a.newVal,this.get("view").set(d,a))}}function s(d){return function(a){var b,f=this.get("view");f&&(b=f.get(d));return b===c?a:b}}function i(d){if(d.target===this){var a=d.component,c=this.get("children"),d=d.index;c.splice(d,0,a);this.get("rendered")&&(a=this.renderChild(a,d));this.fire("afterAddChild",{component:a,index:d})}}function t(d){if(d.target===this){var a=d.component,c,b,f=
d.destroy,g=this.get("children"),d=d.index;-1!=d&&g.splice(d,1);a.setInternal&&a.setInternal("parent",null);if(f)a.destroy&&a.destroy();else if(a.get&&(c=a.get("el")))c=c[0],(b=c.parentNode)&&b.removeChild(c);this.fire("afterRemoveChild",{component:a,index:d})}}function k(d){var b,f,e,h={},i,k=d.get("xrender");b=d.getAttrs();for(e in b)if(f=b[e],f.view){if((i=d.get(e))!==c)h[e]=i;d.on("after"+g.ucfirst(e)+"Change",p(e));f.getter=s(e)}d=d.constructor;for(f=[];d&&d!=r;)(b=a.getXClassByConstructor(d))&&
f.push(b),d=d.superclass&&d.superclass.constructor;h.ksComponentCss=f;return new k(h)}function m(d,a){var c=d.relatedTarget;return c&&(c===a[0]||a.contains(c))}function l(d,a){return function(c){if(!d.get("disabled"))d[a](c)}}var o=g.Env.host.document.documentMode||g.UA.ie,n=e.Gesture,q=g.Features.isTouchSupported(),r=h.extend([j],{isController:!0,getCssClassWithPrefix:a.getCssClassWithPrefix,initializer:function(){var d=this.get("defaultChildCfg");this.publish("beforeAddChild",{defaultFn:i});this.publish("beforeRemoveChild",
{defaultFn:t});d.prefixCls=d.prefixCls||this.get("prefixCls")},createChild:function(d){return b.create(d,this)},createDom:function(){var d;this.setInternal("view",d=k(this));d.create();d=d.getKeyEventTarget();this.get("allowTextSelection")||d.unselectable()},renderUI:function(){this.get("view").render();this.renderChildren()},bindUI:function(){var d=this.getKeyEventTarget();if(this.get("focusable"))d.on("focus",l(this,"handleFocus")).on("blur",l(this,"handleBlur")).on("keydown",l(this,"handleKeydown"));
if(this.get("handleMouseEvents")){d=this.get("el");if(!q)d.on("mouseenter",l(this,"handleMouseEnter")).on("mouseleave",l(this,"handleMouseLeave")).on("contextmenu",l(this,"handleContextMenu"));d.on(n.start,l(this,"handleMouseDown")).on(n.end,l(this,"handleMouseUp")).on("touchcancel",l(this,"handleMouseUp")).on(n.tap,l(this,"performActionInternal"));if(o&&9>o)d.on("dblclick",l(this,"handleDblClick"))}},renderChildren:function(){var d,a=this.get("children");for(d=0;d<a.length;d++)this.renderChild(a[d],
d)},_onSetFocused:function(d){var a=this.getKeyEventTarget()[0];d?a.focus():a.ownerDocument.body.focus()},focus:function(){this.get("focusable")&&this.set("focused",!0)},blur:function(){this.get("focusable")&&this.set("focused",!1)},getChildrenContainerEl:function(){return this.get("view").getChildrenContainerEl()},getKeyEventTarget:function(){return this.get("view").getKeyEventTarget()},addChild:function(d,a){var b=this.get("children");a===c&&(a=b.length);d=this.createChild(d);this.fire("beforeAddChild",
{component:d,index:a});return d},renderChild:function(a,c){var b,f;b=this.get("children");var e;"undefined"===typeof c&&(c=g.indexOf(a,b));a=this.createChild(a);b[c]=a;this.create();e=this.getChildrenContainerEl();f=e[0];b=f.children[c]||null;a.get("rendered")?(e=a.get("el")[0],e.parentNode!=f&&f.insertBefore(e,b)):(b?a.set("elBefore",b):a.set("render",e),a.render());return a},removeChild:function(a,b){b===c&&(b=!0);this.fire("beforeRemoveChild",{component:a,index:g.indexOf(a,this.get("children")),
destroy:b})},removeChildren:function(a){var c,b=[].concat(this.get("children"));for(c=0;c<b.length;c++)this.removeChild(b[c],a);return this},getChildAt:function(a){return this.get("children")[a]||null},handleDblClick:function(a){this.performActionInternal(a)},handleMouseOver:function(a){var c=this.get("el");m(a,c)||this.handleMouseEnter(a)},handleMouseOut:function(a){var c=this.get("el");m(a,c)||this.handleMouseLeave(a)},handleMouseEnter:function(a){this.set("highlighted",!!a)},handleMouseLeave:function(a){this.set("active",
!1);this.set("highlighted",!a)},handleMouseDown:function(a){var c;if(1==a.which||q)if(c=this.getKeyEventTarget(),this.get("activeable")&&this.set("active",!0),this.get("focusable")&&(c[0].focus(),this.set("focused",!0)),!this.get("allowTextSelection"))c=(c=a.target.nodeName)&&c.toLowerCase(),"input"!=c&&"textarea"!=c&&a.preventDefault()},handleMouseUp:function(a){this.get("active")&&(1==a.which||q)&&this.set("active",!1)},handleContextMenu:function(){},handleFocus:function(a){this.set("focused",!!a);
this.fire("focus")},handleBlur:function(a){this.set("focused",!a);this.fire("blur")},handleKeyEventInternal:function(a){return a.keyCode==e.KeyCodes.ENTER?this.performActionInternal(a):c},handleKeydown:function(a){return this.handleKeyEventInternal(a)?(a.halt(),!0):c},performActionInternal:function(){},destructor:function(){var a,c=this.get("view"),b=this.get("children");for(a=0;a<b.length;a++)b[a].destroy&&b[a].destroy();c&&c.destroy()}},{ATTRS:{handleMouseEvents:{value:!0},focusable:{value:!0,view:1},
allowTextSelection:{view:1,value:!1},activeable:{value:!0},focused:{view:1},active:{view:1,value:!1},highlighted:{view:1,value:!1},children:{value:[]},prefixCls:{value:g.config("component/prefixCls")||"ks-",view:1},prefixXClass:{},parent:{setter:function(a,c){(c=this.get("parent"))&&this.removeTarget(c);a&&this.addTarget(a)}},disabled:{view:1,value:!1},xrender:{value:f},defaultChildCfg:{view:1,value:{}}}},{xclass:"controller"});return r},{requires:"./box,event,./impl,./uibase,./manager,./render".split(",")});
KISSY.add("component/base/impl",function(g,j,e){return{Manager:e,UIBase:j,create:function(b,h){var a;if(b){!b.isController&&h&&(g.mix(b,h.get("defaultChildCfg"),!1),!b.xclass&&b.prefixXClass&&(b.xclass=b.prefixXClass,b.xtype&&(b.xclass+="-"+b.xtype)));if(!b.isController&&(a=b.xclass))a=e.getConstructorByXClass(a),b=new a(b);b.isController&&h&&b.setInternal("parent",h)}return b}}},{requires:["./uibase","./manager"]});
KISSY.add("component/base/manager",function(g){function j(a){for(var a=g.trim(a).split(/\s+/),b=0;b<a.length;b++)a[b]&&(a[b]=this.get("prefixCls")+a[b]);return a.join(" ")}var e={},b={},h={__instances:b,addComponent:function(a,f){b[a]=f},removeComponent:function(a){delete b[a]},getComponent:function(a){return b[a]},getCssClassWithPrefix:j,getXClassByConstructor:function(a){for(var b in e)if(e[b].constructor==a)return b;return 0},getConstructorByXClass:function(a){for(var a=a.split(/\s+/),b=-1,c,g=
null,h=0;h<a.length;h++){var i=e[a[h]];if(i&&(c=i.priority)>b)b=c,g=i.constructor}return g},setConstructorByXClass:function(a,b){g.isFunction(b)?e[a]={constructor:b,priority:0}:(b.priority=b.priority||0,e[a]=b)}};h.getCssClassWithPrefix=j;return h});
KISSY.add("component/base/render",function(g,j,e,b,h){return b.extend([j],{initializer:function(){var a=this.get("elAttrs"),b=this.get("elCls"),c;if(c=this.get("disabled"))b.push(this.getCssClassWithState("disabled")),a["aria-disabled"]="true";this.get("highlighted")&&b.push(this.getCssClassWithState("hover"));this.get("focusable")&&(a.hideFocus="true",a.tabindex=c?"-1":"0")},isRender:1,getCssClassWithState:function(a){var b=this.get("ksComponentCss");if(!b)return"";(a=a||"")&&(a="-"+a);return this.getCssClassWithPrefix(b.join(a+
" ")+a)},getCssClassWithPrefix:h.getCssClassWithPrefix,getKeyEventTarget:function(){return this.get("el")},_onSetHighlighted:function(a){var b=this.getCssClassWithState("hover");this.get("el")[a?"addClass":"removeClass"](b)},_onSetDisabled:function(a){var b=this.getCssClassWithState("disabled");this.get("el")[a?"addClass":"removeClass"](b).attr("aria-disabled",a);this.get("focusable")&&this.getKeyEventTarget().attr("tabIndex",a?-1:0)},_onSetActive:function(a){var b=this.getCssClassWithState("active");
this.get("el")[a?"addClass":"removeClass"](b).attr("aria-pressed",!!a)},_onSetFocused:function(a){var b=this.get("el"),c=this.getCssClassWithState("focused");b[a?"addClass":"removeClass"](c)},getChildrenContainerEl:function(){return this.get("el")}},{ATTRS:{prefixCls:{},focusable:{},focused:{sync:0},active:{sync:0},disabled:{sync:0},highlighted:{sync:0}},HTML_PARSER:{disabled:function(a){var b=this.getCssClassWithState("disabled");return a.hasClass(b)}}})},{requires:["./box-render","./impl","./uibase",
"./manager"]});
KISSY.add("component/base/uibase",function(g,j,e,b,h){var e=g.noop,a=j.extend({constructor:function(){var b;a.superclass.constructor.apply(this,arguments);this.decorateInternal&&(b=this.get("srcNode"))&&this.decorateInternal(b);this.get("autoRender")&&this.render()},bindInternal:e,syncInternal:e,initializer:function(){var a,e=g.one(this.get("srcNode"));(a=this.get("id"))&&b.addComponent(a,this);if(e){var f=this.constructor,i,j;j=this.collectConstructorChains();for(a=j.length-1;0<=a;a--)if(f=j[a],
i=f.HTML_PARSER){var f=e,k=void 0,m=void 0,m=void 0;for(k in i)m=i[k],g.isFunction(m)?(m=m.call(this,f),m!==h&&this.setInternal(k,m)):"string"==typeof m?this.setInternal(k,f.one(m)):g.isArray(m)&&m[0]&&this.setInternal(k,f.all(m[0]))}this.setInternal("srcNode",e)}},create:function(){this.get("created")||(this.fire("beforeCreateDom"),this.callMethodByHierarchy("createDom","__createDom"),this.setInternal("created",!0),this.fire("afterCreateDom"),this.callPluginsMethod("createDom"));return this},render:function(){this.get("rendered")||
(this.create(h),this.fire("beforeRenderUI"),this.callMethodByHierarchy("renderUI","__renderUI"),this.fire("afterRenderUI"),this.callPluginsMethod("renderUI"),this.fire("beforeBindUI"),a.superclass.bindInternal.call(this),this.callMethodByHierarchy("bindUI","__bindUI"),this.fire("afterBindUI"),this.callPluginsMethod("bindUI"),a.superclass.syncInternal.call(this),this.sync(),this.setInternal("rendered",!0));return this},sync:function(){this.fire("beforeSyncUI");this.callMethodByHierarchy("syncUI","__syncUI");
this.fire("afterSyncUI");this.callPluginsMethod("syncUI")},createDom:e,renderUI:e,bindUI:e,syncUI:e,plug:function(){var b;b=this.get("plugins");a.superclass.plug.apply(this,arguments);b=b[b.length-1];this.get("rendered")?(b.pluginCreateDom&&b.pluginCreateDom(this),b.pluginRenderUI&&b.pluginRenderUI(this),b.pluginBindUI&&b.pluginBindUI(this),b.pluginSyncUI&&b.pluginSyncUI(this)):this.get("created")&&b.pluginCreateDom&&b.pluginCreateDom(this);return this},destructor:function(){var a;(a=this.get("id"))&&
b.removeComponent(a)}},{name:"UIBase",ATTRS:{rendered:{value:!1},created:{value:!1},xclass:{valueFn:function(){return b.getXClassByConstructor(this.constructor)}}}}),f=a.extend;g.mix(a,{HTML_PARSER:{},extend:function p(a,e,h){var k=g.makeArray(arguments),j={},l,o=k.length,n=k[o-1];if(l=n.xclass)k[o-2].name=l;k=f.apply(this,k);g.isArray(a)&&(g.each(a.concat(k),function(a){a&&g.each(a.HTML_PARSER,function(a,b){j[b]=a})}),k.HTML_PARSER=j);l&&b.setConstructorByXClass(l,{constructor:k,priority:n.priority});
k.extend=p;return k}});return a},{requires:["rich-base","node","./manager"]});
