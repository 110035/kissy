/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Jun 19 14:00
*/
KISSY.add("component/extension/align",function(j,n){function o(a){var c=a.ownerDocument.body,d=l(a).css("position");if(!("fixed"==d||"absolute"==d))return"html"==a.nodeName.toLowerCase()?null:a.parentNode;for(a=a.parentNode;a&&a!=c;a=a.parentNode)if(d=l(a).css("position"),"static"!=d)return a;return null}function p(a){var c,d,b={left:0,right:Infinity,top:0,bottom:Infinity},f;d=a.ownerDocument;c=d.body;for(d=d.documentElement;a=o(a);)if((!v.ie||0!=a.clientWidth)&&a!=c&&a!=d&&"visible"!=l(a).css("overflow"))f=
l(a).offset(),f.left+=a.clientLeft,f.top+=a.clientTop,b.top=Math.max(b.top,f.top),b.right=Math.min(b.right,f.left+a.clientWidth),b.bottom=Math.min(b.bottom,f.top+a.clientHeight),b.left=Math.max(b.left,f.left);a=i.scrollLeft();f=i.scrollTop();b.left=Math.max(b.left,a);b.top=Math.max(b.top,f);c=i.width();d=i.height();b.right=Math.min(b.right,a+c);b.bottom=Math.min(b.bottom,f+d);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:null}function q(a,c,d,b){var f,g;f=a.left;g=a.top;c=r(c,d[0]);
a=r(a,d[1]);a=[a.left-c.left,a.top-c.top];return{left:f-a[0]+ +b[0],top:g-a[1]+ +b[1]}}function s(a,c,d){var b=[];j.each(a,function(a){b.push(a.replace(c,function(a){return d[a]}))});return b}function m(){}function t(a){var c,d;j.isWindow(a[0])?(c={left:i.scrollLeft(),top:i.scrollTop()},d=i.width(),a=i.height()):(c=a.offset(),d=a.outerWidth(),a=a.outerHeight());c.width=d;c.height=a;return c}function r(a,c){var d=c.charAt(0),b=c.charAt(1),f=a.width,g=a.height,e,h;e=a.left;h=a.top;"c"===d?h+=g/2:"b"===
d&&(h+=g);"c"===b?e+=f/2:"r"===b&&(e+=f);return{left:e,top:h}}var u=j.Env.host,l=n.all,i=l(u),v=j.UA;m.__getOffsetParent=o;m.__getVisibleRectForElement=p;m.ATTRS={align:{value:{}}};m.prototype={_onSetAlign:function(a){a&&a.points&&this.align(a.node,a.points,a.offset,a.overflow)},align:function(a,c,d,b){var a=n.one(a||u),d=d&&[].concat(d)||[0,0],b=b||{},f=this.get("el"),g=0,e=p(f[0]),h=t(f),i=t(a),a=q(h,i,c,d),k=j.merge(h,a);if(e&&(b.adjustX||b.adjustY)){if(a.left<e.left||a.left+h.width>e.right)g=
1,c=s(c,/[lr]/ig,{l:"r",r:"l"}),d[0]=-d[0];if(a.top<e.top||a.top+h.height>e.bottom)g=1,c=s(c,/[tb]/ig,{t:"b",b:"t"}),d[1]=-d[1];g&&(a=q(h,i,c,d),j.mix(k,a));c={};c.adjustX=b.adjustX&&(a.left<e.left||a.left+h.width>e.right);c.adjustY=b.adjustY&&(a.top<e.top||a.top+h.height>e.bottom);if(c.adjustX||c.adjustY)b=j.clone(a),g={width:h.width,height:h.height},c.adjustX&&b.left<e.left&&(b.left=e.left),c.resizeWidth&&b.left>=e.left&&b.left+g.width>e.right&&(g.width-=b.left+g.width-e.right),c.adjustX&&b.left+
g.width>e.right&&(b.left=Math.max(e.right-g.width,e.left)),c.adjustY&&b.top<e.top&&(b.top=e.top),c.resizeHeight&&b.top>=e.top&&b.top+g.height>e.bottom&&(g.height-=b.top+g.height-e.bottom),c.adjustY&&b.top+g.height>e.bottom&&(b.top=Math.max(e.bottom-g.height,e.top)),k=j.mix(b,g)}this.set({x:k.left,y:k.top},{force:1});this.set({width:f.width()+k.width-h.width,height:f.height()+k.height-h.height});return this},center:function(a){this.set("align",{node:a,points:["cc","cc"],offset:[0,0]});return this}};
return m},{requires:["node"]});
