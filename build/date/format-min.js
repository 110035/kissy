/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Jul 9 22:45
*/
KISSY.add("date/format",function(p,d,q){function l(b,a,e){e.push({field:b,count:a})}function f(b,a,e,c){c=c||[];e=e||m;if(0<=b){if(100>b&&1<=a&&2>=a)return 10>b&&2==a&&c.push(r),c.push(b),c.join("");if(1E3<=b&&1E4>b){if(4==a)return c.push(b),c.join("");if(2==a&&2==e)return f(b%100,2,2,c)}}c.push(b+"");return c.join("")}function n(b,a){this.locale=a||q;for(var e=b.length,c=!1,d=[],k=null,i=0,j=-1,f=0;f<e;f++){var h=b.charAt(f);if("'"==h){if(f+1<e&&(h=b.charAt(f+1),"'"==h)){f++;0!=i&&(l(j,i,d),j=-1,
i=0);c&&(k+=h);continue}c?(d.push({text:k}),c=!1):(0!=i&&(l(j,i,d),j=-1,i=0),k="",c=!0)}else if(c)k+=h;else if("a"<=h&&"z">=h||"A"<=h&&"Z">=h){if(-1==g.indexOf(h))throw Error("Illegal pattern character '"+h+"'");-1==j||j==h?(j=h,i++):(l(j,i,d),j=h,i=1)}else 0!=i&&(l(j,i,d),j=-1,i=0),d.push({text:h})}if(c)throw Error("Unterminated quote");0!=i&&l(j,i,d);this.pattern=d}function s(b,a,e,c){switch(b){case "G":b=0<c.get(d.YEAR)?1:0;a=e.eras[b];break;case "y":b=c.get(d.YEAR);0>=b&&(b=1-b);a=f(b,2,2!=a?
m:2);break;case "M":b=c.get(d.MONTH);a=4<=a?e.months[b]:3==a?e.shortMonths[b]:f(b+1,2);break;case "k":a=f(c.get(d.HOUR_OF_DAY)||24,a);break;case "E":b=c.get(d.DAY_OF_WEEK);a=4<=a?e.weekdays[b]:e.shortWeekdays[b];break;case "a":a=e.ampms(12<=c.get(d.HOUR_OF_DAY)?1:0);break;case "h":a=f((c.get(d.HOUR_OF_DAY)+1)%12||12,a);break;case "K":a=f(c.get(d.HOUR_OF_DAY)%12,a);break;case "Z":a=c.getTimezoneOffset();e=[0>a?"-":"+"];a=Math.abs(a);e.push(f(Math.floor(a/60)%100,2),f(a%60,2));a=e.join("");break;default:b=
c.get(o[b]),a=f(b,a)}return a}var m=Number.MAX_VALUE,g=Array(d.DAY_OF_WEEK_IN_MONTH+2).join("1"),o={},g=g.split("");g[0]="G";g[d.YEAR]="y";g[d.MONTH]="M";g[d.DAY_OF_MONTH]="d";g[d.HOUR_OF_DAY]="H";g[d.MINUTE]="m";g[d.SECOND]="s";g[d.MILLISECOND]="S";g[d.WEEK_OF_YEAR]="w";g[d.WEEK_OF_MONTH]="W";g[d.DAY_OF_YEAR]="D";g[d.DAY_OF_WEEK_IN_MONTH]="F";p.each(g,function(b,a){o[b]=a});var g=g.join("")+"ahkKZ",r="0";n.prototype={format:function(b){var a=b.getTimeInMillis(),b=new d(this.locale);b.setTimeInMillis(a);
for(var e=[],c=this.pattern,g=c.length,a=0;a<g;a++){var f=c[a];f.text?e.push(f.text):"field"in f&&e.push(s(f.field,f.count,this.locale,b))}return e.join("")}};return n},{requires:["date/gregorian","date/i18n/zh-cn"]});
