/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Jun 21 01:25
*/
KISSY.add("event/custom/observer",function(i,m){function f(){f.superclass.constructor.apply(this,arguments)}i.extend(f,m.Observer,{keys:["fn","context","groups"]});return f},{requires:["event/base"]});KISSY.add("event/custom/object",function(i,m){function f(j){f.superclass.constructor.call(this);i.mix(this,j)}i.extend(f,m.Object);return f},{requires:["event/base"]});
KISSY.add("event/custom/observable",function(i,m,f,j){function g(){g.superclass.constructor.apply(this,arguments);this.defaultFn=null;this.defaultTargetOnly=!1;this.bubbles=!0}var b=j.Utils;i.extend(g,j.Observable,{constructor:g,on:function(a){a=new m(a);-1==this.findObserver(a)&&this.observers.push(a)},fire:function(a){var a=a||{},c=this.bubbles,d=this.currentTarget,e,l=this.type,k=this.defaultFn,n,h=a,b;a.type=l;h instanceof f||(h.target=d,h=new f(h));h.currentTarget=d;a=this.notify(h);!1!==b&&
(b=a);if(c&&!h.isPropagationStopped()){e=(c=d.getTargets(1))&&c.length||0;for(n=0;n<e&&!h.isPropagationStopped();n++)a=c[n].fire(l,h),!1!==b&&(b=a)}if(k&&!h.isDefaultPrevented()&&(l=g.getCustomEvent(h.target,h.type),!this.defaultTargetOnly&&!l.defaultTargetOnly||d==h.target))b=k.call(d,h);return b},notify:function(a){var c=[].concat(this.observers),d,e,b=c.length,k;for(k=0;k<b&&!a.isImmediatePropagationStopped();k++)d=c[k].notify(a,this),!1!==e&&(e=d),!1===d&&a.halt();return e},detach:function(a){var c,
d=a.fn,e=a.context,l=this.currentTarget,k=this.observers,a=a.groups;if(k.length){a&&(c=b.getGroupsRe(a));var n,h,f,i,g=k.length;if(d||c){e=e||l;n=a=0;for(h=[];a<g;++a)if(f=k[a],i=f.context||l,e!=i||d&&d!=f.fn||c&&!f.groups.match(c))h[n++]=f;this.observers=h}else this.reset()}}});g.getCustomEvent=function(a,c,d){var e,b=g.getCustomEvents(a,d);e=b&&b[c];!e&&d&&(e=b[c]=new g({currentTarget:a,type:c}));return e};g.getCustomEvents=function(a,b){!a["__~ks_custom_events"]&&b&&(a["__~ks_custom_events"]={});
return a["__~ks_custom_events"]};return g},{requires:["./observer","./object","event/base"]});
KISSY.add("event/custom/target",function(i,m,f){var j=m.Utils,g=j.splitAndRun;return{isTarget:1,fire:function(b,a){var c=this,d=void 0,e=c.getTargets(1),l=e&&e.length,a=a||{};g(b,function(b){var e;j.fillGroupsForEvent(b,a);b=a.type;if((e=f.getCustomEvent(c,b))||l){if(e){if(!e.hasObserver()&&!e.defaultFn&&(e.bubbles&&!l||!e.bubbles))return}else e=new f({currentTarget:c,type:b});b=e.fire(a);!1!==d&&(d=b)}});return d},publish:function(b,a){var c,d=this;g(b,function(e){c=f.getCustomEvent(d,e,1);i.mix(c,
a)});return d},addTarget:function(b){var a=this.getTargets();i.inArray(b,a)||a.push(b);return this},removeTarget:function(b){var a=this.getTargets(),b=i.indexOf(b,a);-1!=b&&a.splice(b,1);return this},getTargets:function(b){b||(this["__~ks_bubble_targets"]=this["__~ks_bubble_targets"]||[]);return this["__~ks_bubble_targets"]},on:function(b,a,c){var d=this;j.batchForType(function(a,b,c){b=j.normalizeParam(a,b,c);a=b.type;if(a=f.getCustomEvent(d,a,1))a.on(b)},0,b,a,c);return d},detach:function(b,a,c){var d=
this;j.batchForType(function(a,b,c){var g=j.normalizeParam(a,b,c);(a=g.type)?(a=f.getCustomEvent(d,a,1))&&a.detach(g):(a=f.getCustomEvents(d),i.each(a,function(a){a.detach(g)}))},0,b,a,c);return d}}},{requires:["event/base","./observable"]});KISSY.add("event/custom",function(i,m){return{Target:m}},{requires:["./custom/target"]});
