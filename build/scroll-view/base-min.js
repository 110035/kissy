/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Jul 18 22:09
*/
KISSY.add("scroll-view/base/render",function(f,j,n,o){var f=f.Features,k=j.all,m,j={syncUI:function(){var c=this.control,e=c.el,a=c.$contentEl,d=a.height(),b=a.width(),g=e.clientHeight,l,i=e.clientWidth;c.scrollHeight=d;c.scrollWidth=b;c.clientHeight=g;c.clientWidth=i;var h=a.offset();l=c.allowScroll={};d>g&&(l.top=1);b>i&&(l.left=1);c.minScroll={left:0,top:0};var p,f;c.maxScroll={left:p=b-i,top:f=d-g};e=k(e.ownerDocument);c.scrollStep={top:Math.max(0.7*g*g/e.height(),20),left:Math.max(0.7*i*i/e.width(),
20)};e=c.get("snap");g=c.get("scrollLeft");i=c.get("scrollTop");if(e){var a=c.pages="string"==typeof e?a.all(e):a.children(),e=c.get("pageIndex"),j=c.pagesXY=[];a.each(function(a,b){var d=a.offset(),g=d.left-h.left,d=d.top-h.top;g<=p&&d<=f&&(j[b]={x:g,y:d,index:b})});if(e){c.scrollToPage(e);return}}c.scrollToWithBounds({left:g,top:i})},_onSetScrollLeft:function(c){this.control.contentEl.style.left=-c+"px"},_onSetScrollTop:function(c){this.control.contentEl.style.top=-c+"px"}};f.isTransformSupported()&&
(m=f.getTransformProperty(),j._onSetScrollLeft=function(c){var e=this.control;e.contentEl.style[m]="translate3d("+-c+"px,"+-e.get("scrollTop")+"px,0)"},j._onSetScrollTop=function(c){var e=this.control;e.contentEl.style[m]="translate3d("+-e.get("scrollLeft")+"px,"+-c+"px,0)"});return n.getDefaultRender().extend([o],j,{name:"ScrollViewRender"})},{requires:["node","component/container","component/extension/content-render"]});
KISSY.add("scroll-view/base",function(f,j,n,o,k){function m(){var a=this.el,d=a.scrollTop,b=a.scrollLeft;d&&this.set("scrollTop",d+this.get("scrollTop"));b&&this.set("scrollLeft",b+this.get("scrollLeft"));a.scrollTop=a.scrollLeft=0}var c=f.all,f=f.Features.isTouchEventSupported(),e=j.KeyCode;return n.extend({bindUI:function(){this.$el.on("mousewheel",this.handleMouseWheel,this).on("scroll",m,this)},handleKeyDownInternal:function(a){var d=c(a.target),b=d.nodeName();if("input"==b||"textarea"==b||"select"==
b||d.hasAttr("contenteditable"))return k;var a=a.keyCode,b=this.scrollStep,d=k,g=this.isAxisEnabled("x");if(this.isAxisEnabled("y")){var l=b.top,i=this.clientHeight,h=this.get("scrollTop");a==e.DOWN?(this.scrollToWithBounds({top:h+l}),d=!0):a==e.UP?(this.scrollToWithBounds({top:h-l}),d=!0):a==e.PAGE_DOWN?(this.scrollToWithBounds({top:h+i}),d=!0):a==e.PAGE_UP&&(this.scrollToWithBounds({top:h-i}),d=!0)}g&&(b=b.left,g=this.get("scrollLeft"),a==e.RIGHT?(this.scrollToWithBounds({left:g+b}),d=!0):a==e.LEFT&&
(this.scrollToWithBounds({left:g-b}),d=!0));return d},handleMouseWheel:function(a){if(!this.get("disabled")){var d,b,g=this.scrollStep,c,e=this.maxScroll,h=this.minScroll;if((c=a.deltaY)&&this.isAxisEnabled("y")){var f=this.get("scrollTop");d=e.top;b=h.top;f<=b&&0<c||f>=d&&0>c||(this.scrollToWithBounds({top:f-a.deltaY*g.top}),a.preventDefault())}if((c=a.deltaX)&&this.isAxisEnabled("x"))f=this.get("scrollLeft"),d=e.left,b=h.left,f<=b&&0<c||f>=d&&0>c||(this.scrollToWithBounds({left:f-a.deltaX*g.left}),
a.preventDefault())}},isAxisEnabled:function(a){return this.allowScroll["x"==a?"left":"top"]},stopAnimation:function(){this.$contentEl.stop();this.scrollToWithBounds({left:this.get("scrollLeft"),top:this.get("scrollTop")})},_uiSetPageIndex:function(a){this.scrollToPage(a)},_getPageIndexFromXY:function(a,d,b){var c=this.pagesXY.concat([]),e=d?"x":"y";c.sort(function(a,b){return a[e]-b[e]});if(0<b)for(d=0;d<c.length;d++){if(b=c[d],b[e]>=a)return b.index}else for(d=c.length-1;0<=d;d--)if(b=c[d],b[e]<=
a)return b.index;return k},scrollToPage:function(a,d){var b;if((b=this.pagesXY)&&b[a])this.setInternal("pageIndex",a),this.scrollTo({left:b[a].x,top:b[a].y},d)},scrollToWithBounds:function(a,d){var b=this.maxScroll,c=this.minScroll;a.left&&(a.left=Math.min(Math.max(a.left,c.left),b.left));a.top&&(a.top=Math.min(Math.max(a.top,c.top),b.top));this.scrollTo(a,d)},scrollTo:function(a,d){var b=this,c=a.left,e=a.top;if(d){var f=b.get("scrollLeft"),h=b.get("scrollTop");b.$contentEl.animate({xx:{fx:{frame:function(a,
d){c!==k&&b.set("scrollLeft",f+d.pos*(c-f));e!==k&&b.set("scrollTop",h+d.pos*(e-h))}}}},d)}else c!==k&&b.set("scrollLeft",c),e!==k&&b.set("scrollTop",e)}},{ATTRS:{contentEl:{},scrollLeft:{view:1,value:0},scrollTop:{view:1,value:0},focusable:{value:!f},allowTextSelection:{value:!0},handleMouseEvents:{value:!1},snap:{value:!1},snapDuration:{value:0.3},snapEasing:{value:"easeOut"},pageIndex:{value:0},xrender:{value:o}},xclass:"scroll-view"})},{requires:["node","component/container","./base/render"]});
